<!DOCTYPE html>
<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/styleweapons.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Anton&display=swap');
        @import url('http://fonts.cdnfonts.com/css/valorant');
    </style>

    <script>
        function openSidebar() {
            console.log('sidebar');
            document.querySelector('.sidebar').classList.add('open');
            document.getElementById('close').style.display = 'block';
            const video = document.getElementById("video");
            video.play();

        }

        function closeSidebar() {
            console.log('sidebar');
            document.querySelector('.sidebar').classList.remove('open');
            document.getElementById('close').style.display = 'none';
            const video = document.getElementById("video");
            video.pause();
        }
    </script>
    <script>
        $('#audio-control').click(function () {
            if ($("#myVideo").prop('muted')) {
                $("#myVideo").prop('muted', false);
                $(this).text('Mute');
                // or toggle class, style it with a volume icon sprite, change background-position
            } else {
                $("#myVideo").prop('muted', true);
                $(this).text('Unmute');
            }
        });
    </script>


</head>

<body>
    <header>
        <nav>
            <ul>
                <li class="case">
                    <a href="./index.html">Info</a>
                </li>
                <li class="case">
                    <a href="./agents.html">Agentes</a>
                </li>
                <li class="case">
                    <a href="./maps.html">Mapas</a>
                </li>
                <li class="case">
                    <a>Armas</a>
                </li>
            </ul>
        </nav>
        <div class="uptitle">
            <h2>
                vAlorant esp
            </h2>
        </div>
    </header>
    <div class="weapons-body">
        <div class="language-selec">
            <select id="language" onchange="selector()">
                <option value="/?language=es-ES">Spanish</option>

                <option value="/?language=en-US">English</option>

                <option value="/?language=es-MX">Spanish(LATAM)</option>

                <option value="/?language=fr-FR">French</option>

                <option value="/?language=de-DE">Alem√°n</option>

                <option value="/?language=ja-JP">Japones</option>

                <option value="/?language=ko-KR">Koreano</option>

                <option value="/?language=ar-AE">Arabic</option>

                <option value="/?language=id-ID">Indonesian</option>

                <option value="/?language=it-IT">Italian</option>

                <option value="/?language=pt-BR">Portuguese (BR)</option>

                <option value="/?language=pl-PL">Polish</option>

                <option value="/?language=ru-RU">Russian</option>

                <option value="/?language=th-TH">Thai</option>

                <option value="/?language=tr-TR">Turkish</option>

                <option value="/?language=vi-VN">Vietnamese</option>

                <option value="/?language=zh-CN">Chinese(Simplified)</option>

                <option value="/?language=zh-TW">Chinese</option>
            </select>
        </div>
        <div class="weapons-title">

            <h1>
                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Doloribus alias quaerat doloremque cumque cum
                repellendus, sequi, necessitatibus temporibus animi labore maiores iste atque soluta ad! Eveniet
                doloremque error magni optio!
            </h1>
        </div>
        <div class="weaponCards" id="weaponCards" id="overflow">
            <!--<div class="card" onclick="openSidebar(); weaponInfo(0)">
                    <img id="weapon0" src="" />
                    <div class="info">
                        <h1>Vandal</h1>
                        <p>Fusil de larga distancia</p>
                    </div>
                </div>
                <div class="card" onclick="openSidebar()">
                    <img src="" />
                    <div class="info">
                        <h1>Vandal</h1>
                        <p>Fusil de larga distancia</p>
                    </div>
                </div>-->
        </div>
    </div>
    <div class="sidebar" id="sidebar">
        <button tabindex="-1" onclick="closeSidebar()" class="hidden-button-cross btnFilter" id="close">
            <span class="btn__inner">
                <span class="btn__slide"></span>
                <svg xmlns="http://www.w3.org/2000/svg" class="cross-closing" width="24" height="24"
                    viewBox="0 0 24 24">
                    <path
                        d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z" />
                </svg>
            </span>
        </button>

        <div class="gooey" id="gooey">
            <span class="dot"></span>
            <div class="dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <div class="info-displayer">
            <nav class="meganav" id="menu">
                <div class="menu-item highlight">
                    <div class="menu-text">
                        <a class="first-text" id="first-text"></a>
                    </div>
                    <div class="sub-menu double">
                        <div id="weaponlevels">
                            
                        </div>
                        <div class="bottom-container" id="weaponchromas">
                            <div class="colores">Color1</div>
                        </div>
                        <div class="sub-menu-holder" id="sub-menu-holder"></div>
                    </div>
                </div>
            </nav>
        </div>
        <section class="section-slider">
            <video id="video" autoplay mute loop>
                <source id="video-link" src="" type="video/mp4">
            </video>
            <img class="img-skin" id="notvideo" src="">
            <div class="parent">
                <div class="scroll">
                    <ul class="navigation" id="video-list">

                    </ul>
                </div>
            </div>
        </section>
        
    </div>
    <script>
        $('video').on('loadstart', function (event) {
                $('gooey').css('display','block');
        });
        $('video').on('canplay', function (event) {
                $('gooey').css('display','none');
        });
    </script>
    <script>
        var lenguage = '/?language=es-ES';
        var weaponSelected;
        getDataFromApi()

        async function weaponVideo(num) {
            console.log(weaponSelected);
            var url = 'https://valorant-api.com/v1/weapons/' + weaponSelected + lenguage;
            document.querySelector('.gooey').style.display = "block";
            var miRespuesta = await fetch(url,
                {
                    method: 'GET',

                }
            ).then(function (response) {
                return response.json();
            });
            document.querySelector('.gooey').style.display = "none";
            var my_array = miRespuesta.data.skins[num].levels;
            var last_element = my_array[my_array.length - 1];
            console.log(last_element.streamedVideo);
            if (last_element.streamedVideo == null) {
                document.getElementById('notvideo').src = miRespuesta.data.skins[num].displayIcon;
                const video = document.getElementById("video");
                video.pause();
                video.style.display = "none";
                document.getElementById('notvideo').style.display = "block";

            } else {
                document.getElementById('video').src = last_element.streamedVideo;
                const video = document.getElementById("video");
                video.play();
                video.style.display = "block";
                document.getElementById('notvideo').style.display = "none";
            }
            document.getElementById('first-text').innerText = last_element.displayName;
            printWeaponLevels(miRespuesta.data.skins[num].levels);
            printWeaponChromas(miRespuesta.data.skins[num].chromas);
        }

        async function weaponInfo(num) {
            var url = 'https://valorant-api.com/v1/weapons' + lenguage;

            var miRespuesta = await fetch(url,
                {
                    method: 'GET',

                }
            ).then(function (response) {
                return response.json();
            });
            weaponSelected = miRespuesta.data[num].uuid;
            weaponSkins(weaponSelected);
            weaponVideo(0);
        }
        async function weaponSkins(query) {
            var url = 'https://valorant-api.com/v1/weapons/' + query + lenguage;

            var miRespuesta = await fetch(url,
                {
                    method: 'GET',

                }
            ).then(function (response) {
                return response.json();
            });
            printSidebar(miRespuesta.data.skins)
        }
        /*LANGUAGE SELECTOR*/
        function selector() {
            var select = document.getElementById('language');
            lenguage = select.options[select.selectedIndex].value;
            getDataFromApi();
        }
        async function getDataFromApi() {
            var url = 'https://valorant-api.com/v1/weapons' + lenguage;

            var miRespuesta = await fetch(url,
                {
                    method: 'GET',

                }
            ).then(function (response) {
                return response.json();
            });
            printWeapons(miRespuesta.data);
        }

        /*SKIN LEVELS GENERATOR*/
        function printWeaponLevels(levels){
            var level ="";
            levels.forEach(function (element, i) {
                level += '<div class="icon-box gb a">'+ levels[i].displayName +'</div>';
            });
            document.getElementById('weaponlevels').innerHTML = level;
        }

        /*SKIN CHROMAS GENERATOR*/
        function printWeaponChromas(chromas){
            var chroma ="";
            chromas.forEach(function (element, i) {
                chroma += '<div><img class="colores" src="'+ chromas[i].swatch +'"></div>';
            });
            document.getElementById('weaponchromas').innerHTML = chroma;

        }
         /*WEAPON SIDEBAR SKIN GENERATOR*/
        function printSidebar(sidebar) {
            var side = '';

            sidebar.forEach(function (element, i) {
                side += '<li onclick="weaponVideo(' + i + ')"><img src="' + element.displayIcon + '"></li>';
            });
            document.getElementById('video-list').innerHTML = side;
        }
        /*WEAPON SIDEBAR CARD GENERATOR*/
        function printWeapons(weaponCard) {
            var weapon = '';

            weaponCard.forEach(function (element, i) {
                weapon += '<div class="card" onclick="openSidebar(); weaponInfo(' + i + ')"><img class="weapon-img" id="weapon' + i + '" src="' + element.displayIcon + '" /><div class="info"><h1>' + element.displayName + '</div></div>';
            });
            document.getElementById('weaponCards').innerHTML = weapon;
        }

    </script>

    <!--SCRIPT PARA SCROLL HORIZONTAL-->
    <script>
        const slider = document.querySelector('.parent');
        let mouseDown = false;
        let startX, scrollLeft;

        let startDragging = function (e) {
            mouseDown = true;
            startX = e.pageX - slider.offsetLeft;
            scrollLeft = slider.scrollLeft;
        };
        let stopDragging = function (event) {
            mouseDown = false;
        };

        slider.addEventListener('mousemove', (e) => {
            e.preventDefault();
            if (!mouseDown) { return; }
            const x = e.pageX - slider.offsetLeft;
            const scroll = x - startX;
            slider.scrollLeft = scrollLeft - scroll;
        });

        // Add the event listeners
        slider.addEventListener('mousedown', startDragging, false);
        slider.addEventListener('mouseup', stopDragging, false);
        slider.addEventListener('mouseleave', stopDragging, false);
    </script>
</body>

</html>